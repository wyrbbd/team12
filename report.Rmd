---
title: "Report"
author:
- familyname: Wang
  othernames: Yiru
  address: Monash Universtidy
  email: "ywan0553@student.monash.edu"
  correspondingauthor: true
  qualifications: section1
- familyname: Xu
  othernames: Kexin
  address: Monash University
  email: "kxuu0029@student.monash.edu"
  qualifications: section2
  correspondingauthor: true
- familyname: Tang
  othernames: Ruiqi
  address: Monash University
  email: "rtan00062student.monash.edu"
  correspondingauthor: true
  qualifications: section3
department: Our consultancy \newline Yiru Wang &\newline Kexin XU &\newline Ruiqi Tang
organization: Australian Government COVID19
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5 
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
header-includes:
 \usepackage{float}
 \floatplacement{figure}{H}
 \floatplacement{table}{H}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      eval = TRUE,
                      cache=TRUE, 
                      messages=FALSE, 
                      warning=FALSE)
```



```{r , echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tinytex)
library(gridExtra)
library(tidyverse)
library(readr)
library(bookdown)
library(knitr)
library(readxl)
library(haven)
library(kableExtra)
```



\section*{State}

In this section, the number of victims of various crimes in eight Australian states and the number (and rate) of victims per 100,000 people will be analyzed from 2010 to 2019, and the types of crimes with the most victims will be analyzed.

```{r NewSouthWales}
NewSouthWales <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 3,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "NewSouthWales")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r NewSouthWales-rate,message=FALSE}
NewSouthWales_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 3,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "NewSouthWales")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```



```{r Victoria}
Victoria <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 4,range = "A5:AB28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Victoria")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Victoria_rate,message=FALSE}
Victoria_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 4,range = "A29:AB37")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
 mutate(State = "Victoria")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```



```{r Queensland}
Queensland <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 5,range = "A5:AB28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Queensland")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Queensland_rate,message=FALSE}
Queensland_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 5,range = "A29:AB37")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Queensland")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```



```{r South_Australia}
South_Australia <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 6,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "South Australia")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```


```{r South_Australia_rate,message=FALSE}
South_Australia_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 6,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
mutate(State = "South Australia")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Western_Australia}
Western_Australia <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 7,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Western Australia")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Western_Australia_rate,message=FALSE}
Western_Australia_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 7,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Western Australia")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Tasmania1}
Tasmania1 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", 
                       sheet = 8,range = "A5:AB22")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))%>%
  select(!("1993":"2009"))%>%
  pivot_longer(cols = '2010':'2013',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(Count = as.double(Count))%>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Count,State)
```

```{r Tasmania}
Tasmania2 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", 
                       sheet = 8,range = "A5:AB22")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))%>%
  select(!("1993":"2013"))%>%
  pivot_longer(cols = '2014':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
 mutate(State = "Tasmania")%>%
 select(Offence,Year,Count,State)
Tasmania <- bind_rows(Tasmania1,Tasmania2)
```

```{r Tasmania_rate1,message=FALSE}
Tasmania_rate1 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 8,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))%>%
  pivot_longer(cols = '2010':'2013',  
               names_to = "Year",            
               values_to = "Rate") %>%
   mutate(Rate = as.double(Rate))%>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Rate,State)
```

```{r Tasmania_rate,message=FALSE}
Tasmania_rate2 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 8,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))%>%
  pivot_longer(cols = '2014':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Rate,State)
Tasmania_rate <- bind_rows(Tasmania_rate1,Tasmania_rate2)
```


```{r Northern_Territory}
Northern_Territory <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 9,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Northern Territory")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Northern_Territory_rate,message=FALSE}
Northern_Territory_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Northern Territory")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Capital}
Capital <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Capital")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Capital_rate,message=FALSE}
Capital_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Capital")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r State}
State <- bind_rows(NewSouthWales,Victoria,Queensland,South_Australia,Western_Australia,Tasmania,Northern_Territory,Capital)
```

```{r}
State_rate <- bind_rows(NewSouthWales_rate,Victoria_rate,Queensland_rate,South_Australia_rate,Western_Australia_rate,Tasmania_rate,Northern_Territory_rate,Capital_rate)
```


```{r plot1,fig.height = 9, fig.width=10,fig.cap="Comparison of the number of victims of various crimes in each state in the same year"}
State %>%
  ggplot(aes(x = Offence,
             y = Count,
             fill = State))+
  geom_bar(stat  = "identity", position = "dodge") + 
  ggtitle("Comparison of the number of victims of various crimes in each state in the same year") +
  facet_wrap(~Year, ncol = 1,scales= "free")
```

As can be clearly seen in Figure \@ref(fig:plot1), the number of victims of sexual assault and armed robbery was the largest in the same year.

```{r plot2,fig.height = 8, fig.width=8, fig.cap="Rate of change in the number of victims of various crimes by state"}
State %>%
  ggplot(aes( x = Year,     
              y = Count, 
              color = Offence,
              group = Offence)) + 
  geom_line(stat = "identity")  +
  theme(axis.title.x =element_text(size=14), axis.title.y=element_text(size=14)) +
   ggtitle("Rate of change in the number of victims of various crimes by state") +
  facet_wrap(~State, ncol = 1,scales= "free")
```

Figure \@ref(fig:plot2) shows the change in the number of crime victims by state over 10 years.Sexual assault and armed robbery are the most victimized crime categories in every state, while other crimes are victimized in relatively small numbers.



```{r}
State_count1<-State %>%
  filter(Offence == "Sexual assault")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Sexual assault_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
  mutate("Sexual assault_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count2<-State %>%
  filter(Offence == "Murder")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Murder_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("Murder_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count3<-State %>%
  filter(Offence == "Armed robbery")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("robbery_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("robbery_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count4<-State %>%
  filter(Offence == "Manslaughter")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Manslaughter_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
  mutate("Manslaughter_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count5<-State %>%
  filter(Offence == "Kidnapping/abduction")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Kidnapping_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("Kidnapping_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count6<-State %>%
  filter(Offence == "Blackmail/extortion")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("extortion_rate" = ((`2019` - `2010`)/`2010`)*100)%>%
    mutate("extortion_change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)

```


```{r table1,fig.height = 4 , fig.width=6}
state_sum1<-merge(State_count1,State_count2, by= 'State')
state_sum<-merge(State_count3,state_sum1, by= 'State')
knitr::kable(state_sum,caption = 'Ten-year rate of change in the number of victims of various crimes by state',booktabs = TRUE)%>%
   kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r table2}
state_sum2<-merge(State_count4,State_count5, by= 'State')
state_sum3<-merge(State_count6,state_sum2,by= 'State')
knitr::kable(state_sum3,caption = 'Ten-year rate of change in the number of victims of various crimes by state',booktabs = TRUE)%>%
   kable_styling(bootstrap_options = c("striped", "hover"))
```

Table \@ref(tab:table1) and Table \@ref(tab:table2) show the ten-year change and rate of change in the number of victims of the above six types of crime. Sexual assault was the only crime category in which victims increased in all states, with increases of 51.45 per cent in New South Wales, 67.4 per cent in Western Australia, 60.6 per cent in Victoria and 69.4 per cent in the Australian Capital Territory. Victoria was also the only state to see an increase in the number of victims of all six types of crime.

```{r plot3,fig.height = 5 ,fig.width=7,fig.cap="The rate of change in the rate of various crime victims by state"}
State_rate %>%
  filter(Offence == "Sexual assault")%>%
  ggplot(aes( x = Year,     
              y = Rate, 
              color = State,
              group = State)) + 
  geom_line(stat = "identity")  +
  ylab("rate-Victims per 100,000")+
  theme(axis.title.x =element_text(size=14), axis.title.y=element_text(size=14)) +
   ggtitle("Rate of change in the number of victims of various crimes by state") 
```

Since sexual assault is the most victimized crime category and the only one with a 10-year increase in the number of victims in all eight states, we will look at it separately.

Figure \@ref(fig:plot3) shows how the rate of victims of sexual assault (the number of victims per 100,000 people) changed in eight states from 2010 to 2019. New South Wales had the highest rate of victims, while Tasmania had the lowest. Rates of sexual assault victims fluctuated in most states.


```{r table3}
State_rate1<-State_rate %>%
  filter(Offence == "Sexual assault")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Rate)%>%
  mutate("2010-2011" = (`2019` - `2010`))%>%
  mutate("rate_change" =  ((`2019` - `2010`)/`2010`)*100)%>%
  select(!`2010`:`2019`)
 knitr::kable(
State_rate1, booktabs = TRUE,
  caption = 'A 10-year change in the proportion of victims of sexual assault')%>%
   kable_styling(bootstrap_options = c("striped", "hover"))
```

Table \@ref(tab:table3) shows the change of the proportion of victims of sexual assault in all states. Except Queensland, the proportion of victims in all states is increasing. The increase of the proportion of victims in Western Australia, Northern Territory, Australian Capital Territory is more than 40%. Western Australia saw the highest increase of 46.3%.

Based on the above analysis, we can conclude that the state with the most victims among the eight states is New South Wales, and the type of crime with the most victims is sexual assault. The number of victims of sexual assault in each state has increased over the past 10 years, and Western Australia has even increased by 46.3%. Only Queensland has a decrease in the number of victims of sexual assault, which shows that Queensland attaches importance to such crimes.


\section*{Gender}


\section*{Age}
