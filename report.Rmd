---
title: "Analysis of Australian victims from 2010 to 2019"
author:
- familyname: Wang
  othernames: Yiru
  address: Monash Universtidy
  email: "ywan0553@student.monash.edu"
  correspondingauthor: true
  qualifications: section1
- familyname: Xu
  othernames: Kexin
  address: Monash University
  email: "kxuu0029@student.monash.edu"
  qualifications: section2
  correspondingauthor: true
- familyname: Tang
  othernames: Ruiqi
  address: Monash University
  email: "rtan00062student.monash.edu"
  correspondingauthor: true
  qualifications: section3
department: Our consultancy \newline Yiru Wang &\newline Kexin XU &\newline Ruiqi Tang
organization: Australian Government COVID19
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
always_allow_html: true
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
header-includes:
 \usepackage{float}
 \floatplacement{figure}{H}
 \floatplacement{table}{H}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      eval = TRUE,
                      cache=FALSE, 
                      messages=FALSE, 
                      warning=FALSE)
```



```{r, echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tinytex)
library(gridExtra)
library(tidyverse)
library(readr)
library(bookdown)
library(knitr)
library(readxl)
library(haven)
library(kableExtra)
library(plotly)
```

\clearpage


\section*{Introduction}  

This report aims to analyze the changes in the victims of various crimes in Australia from 2010 to 2019. We hope to find some problems by analyzing the data: From the perspective of state, gender and age, how have the victims of various crimes changed in the past ten years?

The report is based on [victim data](https://www.abs.gov.au/statistics/people/crime-and-justice/recorded-crime-victims/latest-release) from the [Australian Bureau of Statistics](https://www.abs.gov.au/). It is a data set generated by regular judicial and criminal investigations and aims to provide the number and rate of victims across Australia in terms of state, gender and age. All ABS data displayed on this website are provided under the Creative Commons Attribution 4.0 international license. It is open data and can be shared freely and adapted for any purpose.


\clearpage


\section*{State}

In this section, the number of victims of various crimes in eight Australian states and the number (and rate) of victims per 100,000 people will be analyzed from 2010 to 2019, and the types of crimes with the most victims will be analyzed.


```{r NewSouthWales}
NewSouthWales <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 3,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "NewSouthWales")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r NewSouthWales-rate,message=FALSE}
NewSouthWales_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 3,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "NewSouthWales")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```



```{r Victoria}
Victoria <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 4,range = "A5:AB28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Victoria")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Victoria_rate,message=FALSE}
Victoria_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 4,range = "A29:AB37")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
 mutate(State = "Victoria")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```

```{r Queensland}
Queensland <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 5,range = "A5:AB28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Queensland")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Queensland_rate,message=FALSE}
Queensland_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 5,range = "A29:AB37")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Queensland")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```



```{r South_Australia}
South_Australia <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 6,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "South Australia")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```


```{r South_Australia_rate,message=FALSE}
South_Australia_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 6,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
mutate(State = "South Australia")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Western_Australia}
Western_Australia <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 7,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Western Australia")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Western_Australia_rate,message=FALSE}
Western_Australia_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 7,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Western Australia")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Tasmania1}
Tasmania1 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", 
                       sheet = 8,range = "A5:AB22")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))%>%
  select(!("1993":"2009"))%>%
  pivot_longer(cols = '2010':'2013',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(Count = as.double(Count))%>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Count,State)
```

```{r Tasmania}
Tasmania2 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", 
                       sheet = 8,range = "A5:AB22")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))%>%
  select(!("1993":"2013"))%>%
  pivot_longer(cols = '2014':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
 mutate(State = "Tasmania")%>%
 select(Offence,Year,Count,State)
Tasmania <- bind_rows(Tasmania1,Tasmania2)
```

```{r Tasmania_rate1,message=FALSE}
Tasmania_rate1 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 8,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))%>%
  pivot_longer(cols = '2010':'2013',  
               names_to = "Year",            
               values_to = "Rate") %>%
   mutate(Rate = as.double(Rate))%>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Rate,State)
```

```{r Tasmania_rate,message=FALSE}
Tasmania_rate2 <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 8,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))%>%
  pivot_longer(cols = '2014':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
 mutate(State = "Tasmania")%>%
  select(Offence,Year,Rate,State)
Tasmania_rate <- bind_rows(Tasmania_rate1,Tasmania_rate2)
```


```{r Northern_Territory}
Northern_Territory <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 9,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Northern Territory")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Northern_Territory_rate,message=FALSE}
Northern_Territory_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Northern Territory")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r Capital}
Capital <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A5:AB30")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Count") %>%
  mutate(State = "Capital")%>%
  select(Offence,Year,Count,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction","Armed robbery","	Unarmed robbery","Blackmail/extortion"))
```

```{r Capital_rate,message=FALSE}
Capital_rate <- read_excel("data/Victims_of_Crime_Extended_time_series.xls", sheet = 10,range = "A31:AB41")%>%
  rename("Offence"= "...1","2010" = "...19" , "2011" = "...20","2012" = "...21","2013"="...22","2014"="...23","2015"="...24","2016"="...25","2017"="...26","2018"="...27","2019"="...28")%>%
  pivot_longer(cols = '2010':'2019',  
               names_to = "Year",            
               values_to = "Rate") %>%
  mutate(State = "Capital")%>%
  select(Offence,Year,Rate,State)%>%
  filter(Offence %in%c("Murder","	
Attempted murder","Manslaughter","Sexual assault","Kidnapping/abduction"))
```


```{r State}
State <- bind_rows(NewSouthWales,Victoria,Queensland,South_Australia,Western_Australia,Tasmania,Northern_Territory,Capital)
```

```{r}
State_rate <- bind_rows(NewSouthWales_rate,Victoria_rate,Queensland_rate,South_Australia_rate,Western_Australia_rate,Tasmania_rate,Northern_Territory_rate,Capital_rate)
```


```{r plot1,fig.height = 9, fig.width=10,fig.cap="Comparison of the number of victims of various crimes in each state in the same year"}
State %>%
  ggplot(aes(x = Offence,
             y = Count,
             fill = State))+
  geom_bar(stat  = "identity", position = "dodge") + 
  ggtitle("Comparison of the number of victims of various crimes in each state in the same year") +
  facet_wrap(~Year, ncol = 1,scales= "free")
```

As can be clearly seen in Figure \@ref(fig:plot1), the number of victims of sexual assault and armed robbery was the largest in the same year.

```{r plot2,fig.height = 8, fig.width=8, fig.cap="Rate of change in the number of victims of various crimes by state"}
State %>%
  ggplot(aes( x = Year,     
              y = Count, 
              color = Offence,
              group = Offence)) + 
  geom_line(stat = "identity")  +
  theme(axis.title.x =element_text(size=14), axis.title.y=element_text(size=14)) +
   ggtitle("Rate of change in the number of victims of various crimes by state") +
  facet_wrap(~State, ncol = 1,scales= "free")
```

Figure \@ref(fig:plot2) shows the change in the number of crime victims by state over 10 years.Sexual assault and armed robbery are the most victimized crime categories in every state, while other crimes are victimized in relatively small numbers.



```{r}
State_count1<-State %>%
  filter(Offence == "Sexual assault")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Sexual assault rate" = ((`2019` - `2010`)/`2010`)*100)%>%
  mutate("Sexual assault change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count2<-State %>%
  filter(Offence == "Murder")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Murder rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("Murder change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count3<-State %>%
  filter(Offence == "Armed robbery")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("robbery rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("robbery change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count4<-State %>%
  filter(Offence == "Manslaughter")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Manslaughter rate" = ((`2019` - `2010`)/`2010`)*100)%>%
  mutate("Manslaughter change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count5<-State %>%
  filter(Offence == "Kidnapping/abduction")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("Kidnapping rate" = ((`2019` - `2010`)/`2010`)*100)%>%
   mutate("Kidnapping change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)
State_count6<-State %>%
  filter(Offence == "Blackmail/extortion")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Count)%>%
  mutate("extortion rate" = ((`2019` - `2010`)/`2010`)*100)%>%
    mutate("extortion change" = (`2019` - `2010`))%>%
  select(!`2010`:`2019`)

```


```{r table1,tab.height = 4 , tab.width=6}
state_sum1<-merge(State_count1,State_count2, by= 'State')
state_sum<-merge(State_count3,state_sum1, by= 'State')
knitr::kable(state_sum,caption = 'Ten-year rate of change in the number of victims of various crimes by state',booktabs = TRUE)%>%
   kable_styling(bootstrap_options = c("striped", "hover"),full_width = T)
```

```{r table2,tab.height = 4 , tab.width=6}
state_sum2<-merge(State_count4,State_count5, by= 'State')
state_sum3<-merge(State_count6,state_sum2,by= 'State')
knitr::kable(state_sum3,caption = 'Ten-year rate of change in the number of victims of various crimes by state',booktabs = TRUE)%>%
   kable_styling(bootstrap_options = c("striped", "hover"),full_width = T)
```

Table \@ref(tab:table1) and Table \@ref(tab:table2) show the ten-year change and rate of change in the number of victims of the above six types of crime. Sexual assault was the only crime category in which victims increased in all states, with increases of 51.45 per cent in New South Wales, 67.4 per cent in Western Australia, 60.6 per cent in Victoria and 69.4 per cent in the Australian Capital Territory. Victoria was also the only state to see an increase in the number of victims of all six types of crime.

```{r plot3,fig.height = 5 ,fig.width=7,fig.cap="The rate of change in the rate of various crime victims by state"}
State_rate %>%
  filter(Offence == "Sexual assault")%>%
  ggplot(aes( x = Year,     
              y = Rate, 
              color = State,
              group = State)) + 
  geom_line(stat = "identity")  +
  ylab("rate-Victims per 100,000")+
  theme(axis.title.x =element_text(size=14), axis.title.y=element_text(size=14)) +
   ggtitle("Rate of change in the number of victims of various crimes by state") 
```

Since sexual assault is the most victimized crime category and the only one with a 10-year increase in the number of victims in all eight states, we will look at it separately.

Figure \@ref(fig:plot3) shows how the rate of victims of sexual assault (the number of victims per 100,000 people) changed in eight states from 2010 to 2019. New South Wales had the highest rate of victims, while Tasmania had the lowest. Rates of sexual assault victims fluctuated in most states.


```{r table3}
State_rate1<-State_rate %>%
  filter(Offence == "Sexual assault")%>%
  pivot_wider(id_cols = State,  
              names_from = Year,  
              values_from = Rate)%>%
  mutate("2010-2011" = (`2019` - `2010`))%>%
  mutate("rate_change" =  ((`2019` - `2010`)/`2010`)*100)%>%
  select(!`2010`:`2019`)
 knitr::kable(
State_rate1, booktabs = TRUE,
  caption = 'A 10-year change in the proportion of victims of sexual assault')%>%
   kable_styling(bootstrap_options = c("striped", "hover"))
```

Table \@ref(tab:table3) shows the change of the proportion of victims of sexual assault in all states. Except Queensland, the proportion of victims in all states is increasing. The increase of the proportion of victims in Western Australia, Northern Territory, Australian Capital Territory is more than 40%. Western Australia saw the highest increase of 46.3%.

Based on the above analysis, we can conclude that the state with the most victims among the eight states is New South Wales, and the type of crime with the most victims is sexual assault. The number of victims of sexual assault in each state has increased over the past 10 years, and Western Australia has even increased by 46.3%. Only Queensland has a decrease in the number of victims of sexual assault, which shows that Queensland attaches importance to such crimes.


\clearpage

\section*{Gender}  

In this section we are going to take a look at crimes across different genders.  
```{r echo=FALSE, message = FALSE, warning = FALSE}
Victims_of_Crime_raw <- readxl::read_excel("data/Victims_of_Crime_Australia.xls", sheet = 3, skip = 4, col_names = FALSE)
Victims_of_Crime <- Victims_of_Crime_raw[-1,1:11]
colnames(Victims_of_Crime) = Victims_of_Crime[1,]
Victims_of_Crime <- Victims_of_Crime[-1,]
Homicide <- Victims_of_Crime[-1,] %>% 
  slice(c(1:18)) %>% 
  filter(`Sex and age` == "Total")
Homicide[1,1] <- "Homicide_Male"
Homicide[2,1] <- "Homicide_Female"
Homicide[3,1] <- "Homicide_All"
Homicide <- Homicide %>% rename("Type_Gender" = `Sex and age`)
Murder <- Victims_of_Crime %>% 
  slice(c(21:38)) %>% 
  filter(`Sex and age` == "Total")
Murder[1,1] <- "Murder_Male"
Murder[2,1] <- "Murder_Female"
Murder[3,1] <- "Murder_All"
Murder <- Murder %>% rename("Type_Gender" = `Sex and age`)
Attemptedmurder <- Victims_of_Crime %>% 
  slice(c(40:57)) %>% 
  filter(`Sex and age` == "Total")
Attemptedmurder[1,1] <- "Attemptedmurder_Male"
Attemptedmurder[2,1] <- "Attemptedmurder_Female"
Attemptedmurder[3,1] <- "Attemptedmurder_All"
Attemptedmurder <- Attemptedmurder %>% rename("Type_Gender" = `Sex and age`)
Manslaughter <- Victims_of_Crime %>% 
  slice(c(59:76)) %>% 
  filter(`Sex and age` == "Total")
Manslaughter[1,1] <- "Manslaughter_Male"
Manslaughter[2,1] <- "Manslaughter_Female"
Manslaughter[3,1] <- "Manslaughter_All"
Manslaughter <- Manslaughter %>% rename("Type_Gender" = `Sex and age`)
Sexualassault <- Victims_of_Crime %>% 
  slice(c(78:110)) %>% 
  filter(`Sex and age` == "Total")
Sexualassault[1,1] <- "Sexualassault_Male"
Sexualassault[2,1] <- "Sexualassault_Female"
Sexualassault[3,1] <- "Sexualassault_All"
Sexualassault <- Sexualassault %>% rename("Type_Gender" = `Sex and age`)
Kidnappingabduction <- Victims_of_Crime %>% 
  slice(c(112:141)) %>% 
  filter(`Sex and age` == "Total")
Kidnappingabduction[1,1] <- "Kidnappingabduction_Male"
Kidnappingabduction[2,1] <- "Kidnappingabduction_Female"
Kidnappingabduction[3,1] <- "Kidnappingabduction_All"
Kidnappingabduction <- Kidnappingabduction %>% rename("Type_Gender" = `Sex and age`)
Robbery <- Victims_of_Crime %>% 
  slice(c(143:175)) %>% 
  filter(`Sex and age` == "Total")
Robbery[1,1] <- "Robbery_Male"
Robbery[2,1] <- "Robbery_Female"
Robbery[3,1] <- "Robbery_All"
Robbery <- Robbery %>% rename("Type_Gender" = `Sex and age`)
Armedrobbery <- Victims_of_Crime %>% 
  slice(c(177:209)) %>% 
  filter(`Sex and age` == "Total")
Armedrobbery[1,1] <- "Armedrobbery_Male"
Armedrobbery[2,1] <- "Armedrobbery_Female"
Armedrobbery[3,1] <- "Armedrobbery_All"
Armedrobbery <- Armedrobbery %>% rename("Type_Gender" = `Sex and age`)
Unarmedrobbery <- Victims_of_Crime %>% 
  slice(c(211:243)) %>% 
  filter(`Sex and age` == "Total")
Unarmedrobbery[1,1] <- "Unarmedrobbery_Male"
Unarmedrobbery[2,1] <- "Unarmedrobbery_Female"
Unarmedrobbery[3,1] <- "Unarmedrobbery_All"
Unarmedrobbery <- Unarmedrobbery %>% rename("Type_Gender" = `Sex and age`)
Blackmailextortion <- Victims_of_Crime %>% 
  slice(c(245:274)) %>% 
  filter(`Sex and age` == "Total")
Blackmailextortion[1,1] <- "Blackmailextortion_Male"
Blackmailextortion[2,1] <- "Blackmailextortion_Female"
Blackmailextortion[3,1] <- "Blackmailextortion_All"
Blackmailextortion <- Blackmailextortion %>% rename("Type_Gender" = `Sex and age`)
Victims_of_Crime_tidy <- bind_rows(Homicide, Murder, Attemptedmurder, Manslaughter, Sexualassault, Kidnappingabduction, Robbery, Armedrobbery, Unarmedrobbery, Blackmailextortion) %>% 
  mutate(`2010` = as.numeric(`2010`)) %>% 
  pivot_longer(cols = -Type_Gender, 
               names_to = "Year",
               values_to = "Number") %>% 
  separate(col = Type_Gender,
           into = c("Type", "Gender"), "_") %>% 
  filter(!Type == "Homicide",
         !Type == "Robbery")
```

```{r gendertotal, fig.cap = "Total number by gender", echo=FALSE, fig.height=10, fig.width=11, message = FALSE, warning = FALSE}
Victims_of_Crime_tidy %>% 
  group_by(Year, Gender) %>%
  summarise(sum = sum(Number)) %>% 
  ggplot(aes(x = Year,
             y = sum,
             color = Gender,
             group = Gender)) +
  geom_line() +
  theme_bw()
```

Figure \@ref(fig:gendertotal) shows:  
* On the whole, it shows an upward trend year by year recently.  
* The number of female victims is much higher than that of male victims, almost twice.


```{r gendertype, fig.cap = "Number by gender by crime type", echo=FALSE, message = FALSE, warning = FALSE}
Victims_of_Crime_tidy %>% 
  ggplot() +
  geom_col(aes(x = Year,
                y = Number,
                fill = Gender),
           position = "dodge") +
  facet_grid(Type~., scales = "free_y") +
  scale_fill_brewer(palette = "Dark2") +
  theme_bw()
```

Figure \@ref(fig:gendertype) shows:  
* With the exception of sexual assault and kidnapping, the majority of victims are men.
* The vast majority of cases are sexual assaults.  
* The number of robberies among the remaining crime categories is also considerable. (Including both armed and unarmed)  
* Possible reasons:
  + Women generally have stronger safety awareness
  + Women are less likely to be seen alone at night in areas where they are likely to be robbed  
    
According to statistics of gender-specific crimes in various countries, male victims are the majority in almost all crimes except for sex-related crimes in which more women are victims.





```{r tablesa, echo=FALSE, message = FALSE, warning = FALSE}
Victims_of_Crime_sum <- Victims_of_Crime_tidy %>% 
  filter(!Gender == "All") %>% 
  group_by(Gender, Year) %>% 
  summarise(sum = sum(Number))

Victims_of_Crime_tidy %>% 
  filter(Type == "Sexualassault" &
         !Gender == "All") %>% 
  left_join(Victims_of_Crime_sum) %>% 
  group_by(Gender, Year) %>% 
  summarise(sa_rate = Number/sum*100) %>% 
  kable(caption = "Sexual Assault Rate") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

Table \@ref(tab:tablesa)
Take sexual assault, female victims of sexual assault make up a very high proportion of total female victims.  


```{r echo=FALSE, message = FALSE, warning = FALSE}
Victims_of_Crime1 <- Victims_of_Crime_raw[-1,c(1, 12:21)]
colnames(Victims_of_Crime1) = Victims_of_Crime1[1,]
Victims_of_Crime1 <- Victims_of_Crime1[-1,]

Sexualassault1 <- Victims_of_Crime1 %>% 
  slice(c(78:110)) %>% 
  filter(`Sex and age` == "Total")
Sexualassault1[1,1] <- "Sexualassault_Male"
Sexualassault1[2,1] <- "Sexualassault_Female"
Sexualassault1[3,1] <- "Sexualassault_All"
Sexualassault1 <- Sexualassault1 %>% rename("Type_Gender" = `Sex and age`)

Sexualassault_rate <- Sexualassault1 %>% 
  mutate(`2010` = as.numeric(`2010`)) %>% 
  pivot_longer(cols = -Type_Gender, 
               names_to = "Year",
               values_to = "Rate") %>% 
  separate(col = Type_Gender,
           into = c("Type", "Gender"), "_") %>% 
  filter(!Gender == "All")
```




```{r gendersa, fig.cap = "Rate by gender in Sexual Assault", echo=FALSE, message = FALSE, warning = FALSE}
sa <- Sexualassault_rate %>%
  ggplot() +
  geom_col(aes(x = Year,
               y = Rate,
               fill = Gender),
               position = "dodge") +
  theme_bw() +
  scale_fill_brewer(palette = "Dark2") + 
  theme(legend.position = "bottom")
sa
#ggplotly(sa)
```

Figure \@ref(fig:gendersa) shows:  

* Rate is calculated by victim number divided by 100,000 persons.
* Show an upward pattern over years.
* Higher than 0.15% in recent years which means 3 out of every 2,000 people have been sexually assaulted.
* Possible reasons:
  + Women are physically vulnerable
  + Men are more sexually impulsive
  + Many women may choose not to report the crime
    - relationship to the offender
    - confidence in the justice system
    - fear of revenge
    - public opinion  
  
ABS personal safety survey also measures the number of women who contacted the police about the most recent incident within the last 10 years. Only 13.4% of women did so. 



\clearpage



\section*{Age}
For my part, my main job is to investage the victims for the different age groups. I divide the age into four group, teenage, adult, elder adult, and elder. I will compare different class of victims for different groups

``` {r, echo = FALSE, message = FALSE, warning = FALSE}
Homicide <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A20", dim = c(6,11))) 
colnames(Homicide) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Murder <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A39", dim = c(6,11)))
colnames(Murder) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Attempted_murder <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A58", dim = c(6,11))) 

colnames(Attempted_murder) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Manslaughter <-  read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A77", dim = c(6,11)))

colnames(Manslaughter) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Sexual_assault <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A106", dim = c(10,11)))

colnames(Sexual_assault) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Kidnapping_abduction <-  read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A138", dim = c(9,11)))

colnames(Kidnapping_abduction) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Robbery <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A171", dim = c(10,11)))

colnames(Robbery) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Armed_robbery <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A205", dim = c(10,11)))

colnames(Armed_robbery) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Unarmed_robbery <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A239", dim = c(10,11)))

colnames(Unarmed_robbery) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

Blackmail_extortion <- read_excel("data/Victims_of_Crime_Australia.xls", 
    sheet = "Table 2", range = anchored("A271", dim = c(9,11)))

colnames(Blackmail_extortion) <- c("age" ,2010, 2011, 2012, 2013,	2014,	2015,	2016,	2017,	2018,	2019)

```


```{r Homicide, echo = FALSE, message = FALSE, warning = FALSE}
Homicide %>%
 pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> homicide_long

homicide_long %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "Homicide") -> homicide_wider

homicide_long %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Homicide") %>%
  filter(age != "Total") -> homicide_age

homicide_age %>%
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Homicide")-> p1
```


``` {r Murder, echo = FALSE, message = FALSE, warning = FALSE}
Murder %>%
pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> murder_longer

murder_longer %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "Murder") -> murder_wider

murder_longer %>%
   group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Murder") %>%
  filter(age != "Total") -> murder_age

murder_age %>%
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Murder") -> p2
```

``` {r Attempted_murder, echo = FALSE, message = FALSE, warning = FALSE}
Attempted_murder %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> AM_longer

AM_longer %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  
  mutate(class = "Attempted") -> AM_wider

AM_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Attempted") %>%
  filter(age != "Total") -> am_age

am_age %>%
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Attempted murder") -> p3
```

``` {r Manslaughter, echo = FALSE, message = FALSE, warning = FALSE}
Manslaughter %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> manslaughter_longer

manslaughter_longer %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "Manslaughter") -> manslaughter_wider

AM_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Manslaughter") %>%
  filter(age != "Total") -> manslaughter_age
manslaughter_age %>% 
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Manslaughter") -> p4
```

``` {r Sexual_assault, echo = FALSE, message = FALSE, warning = FALSE}
Sexual_assault %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> SA_longer_edit

SA_longer_edit %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) -> SA_wider_edit

SA_wider_edit %>%
  mutate(
    `0–19 years` = `0–9 years` + `10–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`,
    `55 years and over` = `55–64 years`+`55–64 years`+ `65 years and over`
  ) %>%
  select(Year, `0–19 years`:`55 years and over`)  -> SA_wider

SA_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") %>%
  mutate(class = "Sexual") -> SA_longer

SA_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Sexual") %>%
  filter(age != "Total") -> SA_age

SA_age%>%
  ggplot() + geom_col(aes(x = age ,y = sum, fill = age)) + 
  ggtitle("Sexual assault") -> p5
```

``` {r Kidnapping_abduction, echo = FALSE, message = FALSE, warning = FALSE}
Kidnapping_abduction %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> ka_longer_edit

ka_wider_edit <- ka_longer_edit %>% 
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) 
  
ka_wider_edit %>%
   mutate(
    `0–19 years` = `0–9 years` + `10–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`
  ) %>%
  select(Year, `55 years and over`:`35–54 years`) -> ka_wider

ka_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") -> ka_longer
  

ka_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "abduction") %>%
  filter(age != "Total") -> ka_age
ka_age %>%
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Kidnapping abduction") -> p6
```

``` {r Robber, echo = FALSE, message = FALSE, warning = FALSE}
Robbery %>%
   pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> Robbery_longer_edit

Robbery_longer_edit %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "robbery") -> Robbery_wider_edit

Robbery_wider_edit %>%
  mutate(
    `0–19 years` = `0–9 years` + `10–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`,
    `55 years and over` = `55–64 years`+`55–64 years`+ `65 years and over`
  ) %>%
  select(Year, `0–19 years`:`55 years and over`) -> Robbery_wider

Robbery_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") %>%
  mutate(class = "robbery") -> Robbery_longer
  

Robbery_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "robbery") %>%
  filter(age != "Total") -> robbery_age
robbery_age %>% 
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Robber") -> p7
```

``` {r Armed_robbery, echo=FALSE, message = FALSE, warning = FALSE}
Armed_robbery %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> AR_longer_edit

AR_longer_edit %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) -> AR_wider_edit

AR_wider_edit %>%
  mutate(
    `0–19 years` = `0–9 years` + `10–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`,
    `55 years and over` = `55–64 years`+`55–64 years`+ `65 years and over`
  ) %>%
  select(Year, `0–19 years`:`55 years and over`) -> AR_wider

AR_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") %>%
  mutate(class = "Armed") -> AR_longer

AR_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Armed") %>%
  filter(age != "Total") -> AR_age
AR_age %>% 
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) + 
  ggtitle("Armed robbery") -> p8
```

``` {r Unarmed_robbery, echo = FALSE, message = FALSE, warning = FALSE}
Unarmed_robbery %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> UR_longer_edit

UR_longer_edit %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "Unarmed") -> UR_wider_edit

UR_wider_edit %>%
  mutate(
    `0–19 years` = `0–9 years` + `10–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`,
    `55 years and over` = `55–64 years`+`55–64 years`+ `65 years and over`
  ) %>%
  select(Year, `0–19 years`:`55 years and over`) -> UR_wider

UR_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") %>%
  mutate(class = "Unarmed") -> UR_longer

UR_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Unarmed") %>%
  filter(age != "Total") -> UR_age

UR_age %>%
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) +
  ggtitle("Unarmed robbery") -> p9
```

``` {r Blackmail_extortion, echo = FALSE, message = FALSE, warning = FALSE}
Blackmail_extortion %>%
  pivot_longer(cols = '2010':'2019',  
                names_to = "Year",            
                values_to = "Count") -> BE_longer_edit

BE_longer_edit %>%
  pivot_wider(id_cols = c(age, Year, Count), names_from = age, values_from = Count) %>%
  mutate(Year = as_factor(Year)) %>%
  mutate(class = "Blackmail") -> BE_wider_edit

BE_wider_edit %>%
  mutate(
    `0–19 years` =  `0–14 years` + `15–19 years`,
    `20–34 years` = `20–24 years` + `25–34 years`,
    `35–54 years` = `35–44 years` + `45–54 years`,
    `55 years and over` = `55–64 years`+`55–64 years`+ `65 years and over`
  ) %>%
  select(Year, `0–19 years`:`55 years and over`) -> BE_wider

BE_wider %>%
  pivot_longer(cols = -Year, names_to = "age", values_to = "Count") %>%
  mutate(class = "Blackmail") -> BE_longer
  

BE_longer %>%
  group_by(age) %>%
  summarise(sum = sum(Count)) %>%
  mutate(class = "Blackmail") %>%
  filter(age != "Total") -> BE_age
BE_age %>% 
  ggplot() + geom_col(aes(x= age, y = sum, fill = age)) + 
  ggtitle("Blackmail extortion") -> p10
```



``` {r combine, echo = FALSE, message = FALSE, warning = FALSE}
homicide_age %>%
  full_join(robbery_age, key = age, by = c("age", "sum", "class"))%>%
  full_join(ka_age, key = age, by = c("age", "sum", "class")) %>% 
  full_join(am_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(murder_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(manslaughter_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(SA_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(AR_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(UR_age, key = age, by = c("age", "sum", "class")) %>%
  full_join(BE_age, key = age, by = c("age", "sum", "class"))-> data

data %>%
  ggplot() + geom_col(aes(x= class, y = sum, fill = age), position = "fill") -> p_hist
```
from graph, we can see that Sexual assauslt is the largest part, compared with other class
From the graph, we can see that the people who are 35-54 have bigger probability to has crimal recod

```{r, echo=FALSE, message = FALSE, warning = FALSE}
AM_wider$`0–19 years` + AR_wider$`0–19 years`+ BE_wider$`0–19 years` + homicide_wider$`0–19 years` + ka_wider$`0–19 years` + manslaughter_wider$`0–19 years`+murder_wider$`0–19 years`+Robbery_wider$`0–19 years` + SA_wider$`0–19 years`+ UR_wider$`0–19 years` -> teenage

AM_wider$`20–34 years`  + AR_wider$`20–34 years` + BE_wider$`20–34 years` + homicide_wider$`20–34 years` + ka_wider$`20–34 years` + manslaughter_wider$`20–34 years` + murder_wider$`20–34 years` + Robbery_wider$`20–34 years` + SA_wider$`20–34 years` + UR_wider$`20–34 years` -> adult

AM_wider$`35–54 years`  + AR_wider$`35–54 years` + BE_wider$`35–54 years` + homicide_wider$`35–54 years` + ka_wider$`35–54 years` + manslaughter_wider$`35–54 years` + murder_wider$`35–54 years` + Robbery_wider$`35–54 years` + SA_wider$`35–54 years` + UR_wider$`35–54 years` -> elder_adult

AM_wider$`55 years and over`  + AR_wider$`55 years and over` + BE_wider$`55 years and over` + homicide_wider$`55 years and over` + ka_wider$`55 years and over` + manslaughter_wider$`55 years and over` + murder_wider$`55 years and over` + Robbery_wider$`55 years and over` + SA_wider$`55 years and over` + UR_wider$`55 years and over` -> elder
```


```{r, echo=FALSE, message = FALSE, warning = FALSE}
Year <- 2010:2019
tibble(Year, teenage, adult, elder_adult, elder) -> age_total
age_total %>%
  mutate(Year = as.numeric(Year)) -> age

ggplot() +
  geom_line(aes(x=Year, y = teenage), data =age %>% select(Year, teenage)) +
  ggtitle("Teenage") -> p_teenage
ggplot() +
  geom_line(aes(x=Year, y = adult), data = age %>% select(Year, adult)) +
  ggtitle("adult") -> p_adult
ggplot() +
  geom_line(aes(x=Year, y = elder_adult), data = age %>% select(Year, elder_adult)) +
  ggtitle("elder_adult") -> p_elder_adult
ggplot() +
  geom_line(aes(x=Year, y = elder), data =age %>% select(Year, elder)) +
  ggtitle("elder") -> p_elder
```

```{r ageplot, fig.height = 8, fig.width=8, fig.cap="Age group between 2010 to 2019"}
grid.arrange(p_teenage, p_adult, p_elder_adult, p_elder)
```

From \@ref(fig:ageplot), we can see that the trend for both teenage and adult is very similar. it has a decrease trend from 2010 to 2015. Then, it has a increse trend from 2015 to 2019. For the elder adult and elder, they have increase trend for all year.

```{r agedist, fig.height = 5, fig.width=8, fig.cap="Age in class"}
p_hist
```

From \@ref(fig:agedist). we can see that 20-54 years age are the largest people for victims record. The 55 year and over are the smallest group.

For all class of victims
```{r class, fig.height = 5, fig.width=8, fig.cap="all class"}
data %>%
  ggplot() + geom_col(aes(x= class, y = sum, fill = age))
```

The \@ref(fig:class) shows that the the number of people committed Sexual is the largest

Then, There are the each class victims

```{r Homplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p1
```

```{r murplot, echo = FALSE, message = FALSE, warning = FALSE,fig.height = 5, fig.width=5}
p2
```

```{r attplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p3
```

```{r manplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p4
```

```{r sexplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p5
```

```{r kidplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p6
```

```{r rplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p7
```

```{r armplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p8
```

```{r unplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p9
```

```{r blaplot, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 5, fig.width=5}
p10
```

\clearpage
\section*{Conclusion}  

Our group just investage victims of various crimes in Australia from 2010 to 2019. We analysis in this topic in **State**, **Gender** and **Age**. Overall, We find that the number of crimes has increase in recent five years and sexual assualt makes up the vast majority of victims of all types of crime. To some extent the government needs more strict laws and controls so that fewer people suffer from these. 

\clearpage
\section*{References}    

**R packages**
  
* Hao Zhu (2021). kableExtra: Construct Complex Table with 'kable' and Pipe Syntax. R package version 1.3.4.
  https://CRAN.R-project.org/package=kableExtra    
* Yihui Xie (2021). tinytex: Helper Functions to Install and Maintain TeX Live, and Compile LaTeX
  Documents. R package version 0.31.  
* Baptiste Auguie (2017). gridExtra: Miscellaneous Functions for "Grid" Graphics. R package version 2.3.
  https://CRAN.R-project.org/package=gridExtra     
* Hadley Wickham and Jim Hester (2020). readr: Read Rectangular Text Data. R package version 1.4.0.
  https://CRAN.R-project.org/package=readr  
* Yihui Xie (2021). bookdown: Authoring Books and Technical Documents with R Markdown. R package version
  0.22.  
* Hadley Wickham and Jennifer Bryan (2019). readxl: Read Excel Files. R package version 1.3.1.
  https://CRAN.R-project.org/package=readxl  
* Yihui Xie (2021). knitr: A General-Purpose Package for Dynamic Report Generation in R. R package version
  1.33.  
* C. Sievert. Interactive Web-Based Data Visualization with R, plotly, and shiny. Chapman and Hall/CRC
  Florida, 2020.  
  
**Data Resources**   
  
* [Recorded Crime - Victims, Australia](https://www.abs.gov.au/statistics/people/crime-and-justice/recorded-crime-victims/latest-release)     
  
    
**Software**  
  
* [RStudio](http://www.rstudio.com/)    
* [R](https://www.R-project.org/)   

**Literature**  
* [Sexual assault in Australia](https://www.aihw.gov.au/getmedia/0375553f-0395-46cc-9574-d54c74fa601a/aihw-fdv-5.pdf.aspx?inline=true)  
* [An exploratory analysis of armed robbery in Australia](https://www.aic.gov.au/publications/tbp/tbp7)  